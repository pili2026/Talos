version: 1.0.0
SD400:
  default_controls: 
    # VFD1 Emergency Control - Monitor AIn01 sensor
    - name: Emergency High Water Temperature Override VFD1
      code: EMERGENCY_HIGH_WATER_TEMP_VFD1
      priority: 151
      composite:
        any:
          - type: threshold
            source: AIn01
            operator: gt
            threshold: 32.0
            hysteresis: 2.0  # Only when the temperature drops to 30°C will it be released
            debounce_sec: 2.0
      policy:
        type: discrete_setpoint
      action:
        model: TECO_VFD
        slave_id: '1'
        type: set_frequency
        target: RW_HZ
        value: 60
        emergency_override: true
        
    # VFD2 Emergency Control - Monitor AIn02 sensor
    - name: Emergency High Water Temperature Override VFD2
      code: EMERGENCY_HIGH_WATER_TEMP_VFD2
      priority: 150
      composite:
        any:
          - type: threshold
            source: AIn02
            operator: gt
            threshold: 34.0
            hysteresis: 2.0  # Only when the temperature drops to 32°C will it be released
            debounce_sec: 2.0
      policy:
        type: discrete_setpoint
      action:
        model: TECO_VFD
        slave_id: '2'
        type: set_frequency
        target: RW_HZ
        value: 60
        emergency_override: true
  instances:
    '3':
      use_default_controls: false
      controls:
        - name: Supply-Return Temperature Difference Control
          code: LIN_INC01
          priority: 90
          composite:
            any:
              - type: difference
                sources:
                  - AIn01
                  - AIn02
                operator: gt
                threshold: 3
                abs: false
          policy:
            type: incremental_linear
            condition_type: difference
            sources:
              - AIn01
              - AIn02
            gain_hz_per_unit: 1.5
          action:
            model: TECO_VFD
            slave_id: '2'
            type: adjust_frequency
            target: RW_HZ