version: "1.0.0"

SD400:
  default_controls: []
  instances:
    "3":
      use_default_controls: false
      controls:
        # ===========================================
        # DISCRETE_SETPOINT - Fixed value control
        # ===========================================
        - name: "High Temperature Shutdown"
          code: "HIGH_TEMP"
          priority: 80
          composite:
            any:
              - type: threshold
                source: AIn01
                operator: gt
                threshold: 40.0
                hysteresis: 1.0
                debounce_sec: 0.5
              - type: threshold
                source: AIn03
                operator: between
                min: 3.0
                max: 5.0
                hysteresis: 0.2
          policy:
            type: discrete_setpoint
          action:
            model: TECO_VFD
            slave_id: "2"
            type: set_frequency
            target: RW_HZ
            value: 45.0

        # ===========================================
        # ABSOLUTE_LINEAR - Single temperature mapping
        # ===========================================
        - name: "Environment Temperature Linear Control"
          code: "LIN_ABS01"
          priority: 85
          composite:
            any:
              - type: threshold
                source: AIn01           # Single sensor
                operator: gt
                threshold: 25.0         # Trigger when temp > 25°C
                abs: false
          policy:
            type: absolute_linear
            condition_type: threshold      # Single sensor input
            source: AIn01              # Temperature sensor
            base_freq: 40.0            # Frequency at base_temp
            base_temp: 25.0            # Base temperature (25°C ↔ 40Hz)
            gain_hz_per_unit: 1.2      # 1°C → 1.2Hz
            # Removed: min_freq, max_freq, deadband
          action:
            model: TECO_VFD
            slave_id: "2"
            type: set_frequency        # Absolute setting
            target: RW_HZ
            # value calculated by evaluator

        # ===========================================
        # INCREMENTAL_LINEAR - Temperature difference adjustment
        # ===========================================
        - name: "Supply-Return Temperature Difference Control"
          code: "LIN_INC01"
          priority: 90
          composite:
            any:
              - type: difference
                sources: [AIn01, AIn02]  # Supply - Return temperature
                operator: gt
                threshold: 4.0           # Trigger when diff > 4°C
                abs: false
              - type: difference
                sources: [AIn01, AIn02]
                operator: lt
                threshold: -4.0          # Trigger when diff < -4°C  
                abs: false
          policy:
            type: incremental_linear
            condition_type: difference   # Temperature difference input
            sources: [AIn01, AIn02]     # Two sensors
            gain_hz_per_unit: 1.5       # 1°C diff → ±1.5Hz adjustment
          action:
            model: TECO_VFD
            slave_id: "2"
            type: adjust_frequency      # Incremental adjustment
            target: RW_HZ
            # value calculated by evaluator

